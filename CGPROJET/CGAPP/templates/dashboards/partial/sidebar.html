{% load static %}

<div class="sidebar pe-4 pb-3" style="width: 250px; min-height: 100vh; position: fixed; left: 0; top: 0; background-color: var(--white-bg); z-index: 1000; overflow-y: auto;">
    <nav class="navbar navbar-light" style="background-color: var(--white-bg); flex-direction: column; align-items: flex-start;">
        <a href="{% url 'home' %}" class="navbar-brand mx-4 mb-3">
            <h3 class="text-primary">
                <img class="rounded-circle" src="{% static 'logo.png' %}" alt="Logo" style="width: 40px; height: 40px;">
            </h3>
        </a>

        <div class="d-flex align-items-center ms-4 mb-4">
            <div class="position-relative">
                {% if user.profile_picture %}
                    <img class="rounded-circle" src="{{ user.profile_picture.url }}" alt="{{ user.username }}" style="width: 40px; height: 40px; object-fit: cover;">
                {% else %}
                    <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px; background-color: #00B8B5; color: white; font-weight: bold;">
                        {{ user.username|first|upper }}
                    </div>
                {% endif %}
                <div class="bg-success rounded-circle border border-2 border-white position-absolute end-0 bottom-0 p-1"></div>
            </div>
            <div class="ms-3">
                <h6 class="mb-0">{{ user.username }}</h6>
                <span>{{ user.date_joined|date }}</span>
            </div>
        </div>

        <div class="navbar-nav w-100">
            {% if user.role == 'gerant' %}
                <a href="{% url 'dashboard_gerant' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'dashboard_gerant' %}active{% endif %}">
                    <i class="fa fa-home me-2"></i>Dashboard
                </a>

                <a href="{% url 'liste_produits' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'liste_produits' %}active{% endif %}">
                    <i class="fa fa-box me-2"></i>Gestion Produits
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-tags me-2"></i>Gestion Catégories
                </a>

                <a href="{% url 'liste_serveurs' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'liste_serveurs' %}active{% endif %}">
                    <i class="fa fa-user-friends me-2"></i>Gestion Serveurs
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-receipt me-2"></i>Gestion Cmd
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-warehouse me-2"></i>Gestion Stock
                </a>

                <a href="{% url 'profile' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
                    <i class="fa fa-user-circle me-2"></i>Profil
                </a>

                <a href="{% url 'deconnexion' %}" class="nav-item nav-link text-danger">
                    <i class="fa fa-sign-out-alt me-2"></i>Déconnexion
                </a>

           {% elif user.role == 'client' %}
            <a href="{% url 'dashboard_client' %}" 
            class="nav-item nav-link {% if request.resolver_match.url_name == 'dashboard_client' %}active{% endif %}">
            <i class="fas fa-home me-2"></i>Dashboard
            </a>

            <a href="{% url 'produits' %}" 
            class="nav-item nav-link {% if request.resolver_match.url_name == 'produits' %}active{% endif %}">
            <i class="fas fa-shopping-bag me-2"></i>Achat
            </a>

            <a href="{% url 'panier' %}"  
            class="nav-item nav-link {% if request.resolver_match.url_name == 'panier' %}active{% endif %}">
            <i class="fas fa-shopping-cart me-2"></i>Panier
            </a>

            <a href="{% url 'historique_client' %}" 
            class="nav-item nav-link {% if request.resolver_match.url_name == 'historique_client' %}active{% endif %}">
            <i class="fas fa-history me-2"></i>Historiques
            </a>

            <a href="{% url 'contact' %}" 
            class="nav-item nav-link {% if request.resolver_match.url_name == 'contact' %}active{% endif %}">
            <i class="fas fa-headset me-2"></i>Support
            </a>

            <a href="{% url 'tableau_avis' %}" 
            class="nav-item nav-link {% if request.resolver_match.url_name == 'tableau_avis' %}active{% endif %}">
            <i class="fas fa-headset me-2"></i> tableau d'avis
            </a>


            {% elif user.role == 'admin' %}
                <a href="{% url 'dashboard_admin' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'dashboard_admin' %}active{% endif %}">
                    <i class="fa fa-home me-2"></i>Dashboard
                </a>

                <a href="{% url 'creer_gerant' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'creer_gerant' %}active{% endif %}">
                    <i class="fa fa-user-plus me-2"></i>Ajout Gérant
                </a>

                <a href="{% url 'creer_serveur' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'creer_serveur' %}active{% endif %}">
                    <i class="fa fa-user-plus me-2"></i>Ajout Serveur
                </a>

                <a href="{% url 'liste_utilisateurs' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'liste_utilisateurs' %}active{% endif %}">
                    <i class="fa fa-users me-2"></i>Liste utilisateurs
                </a>

                <a href="{% url 'historique_actions' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'historique_actions' %}active{% endif %}">
                    <i class="fa fa-history me-2"></i>Historique
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-cogs me-2"></i>Paramètres
                </a>
                
                <a href="{% url 'liste_produits' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'liste_produits' %}active{% endif %}">
                    <i class="fa fa-box me-2"></i>Gestion Produits
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-tags me-2"></i>Gestion Catégories
                </a>

                <a href="{% url 'liste_serveurs' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'liste_serveurs' %}active{% endif %}">
                    <i class="fa fa-user-friends me-2"></i>Gestion Serveurs
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-receipt me-2"></i>Gestion Cmd
                </a>

                <a href="#" class="nav-item nav-link">
                    <i class="fa fa-warehouse me-2"></i>Gestion Stock
                </a>
            {% elif user.role == 'serveur' %}
                <a href="{% url 'dashboard_serveur' %}" 
                class="nav-item nav-link {% if request.resolver_match.url_name == 'dashboard_serveur' %}active{% endif %}">
                <i class="fa fa-home me-2"></i>Dashboard
                </a>

                <a href="{% url 'liste_produits_serveur' %}" 
                class="nav-item nav-link {% if request.resolver_match.url_name == 'liste_produits_serveur' %}active{% endif %}">
                <i class="fa fa-box me-2"></i>Listes Produits
                </a>

                <a href="{% url 'commandes_en_attente' %}" 
                class="nav-item nav-link {% if request.resolver_match.url_name == 'commandes_en_attente' %}active{% endif %}">
                <i class="fa fa-hourglass-half me-2"></i>Listes cmdes
                </a>

                <a href="{% url 'nouvelle_commande_serveur' %}" 
                class="nav-item nav-link {% if request.resolver_match.url_name == 'nouvelle_commande_serveur' %}active{% endif %}">
                <i class="fa fa-plus-circle me-2"></i>Ajout cmdes
                </a>

                <a href="{% url 'commandes_livrees_serveur' %}" 
                class="nav-item nav-link {% if request.resolver_match.url_name == 'commandes_livrees_serveur' %}active{% endif %}">
                <i class="fa fa-check-circle me-2"></i>Cmdes livrées
                </a>
            {% endif %}


             <a href="{% url 'profile' %}" class="nav-item nav-link {% if request.resolver_match.url_name == 'profile' %}active{% endif %}">
                    <i class="fa fa-user-circle me-2"></i>Profil
                </a>

                <a href="{% url 'deconnexion' %}" class="nav-item nav-link text-danger">
                    <i class="fa fa-sign-out-alt me-2"></i>Déconnexion
                </a>

        </div>
    </nav>
</div>

<style>
:root {
    --yellow-canaan: #FDCB05;
    --teal-glacier: #00B8B5;
    --pink-swoosh: #E91E63;
    --black-shadow: #000000;
    --white-bg: #FFFFFF;
}

.sidebar {
    background-color: var(--white-bg);
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
}



.nav-link {
    transition: all 0.3s ease;
    border-radius: 0.375rem;
    padding: 12px 15px;
    margin: 4px 10px;
    color: var(--black-shadow);
    position: relative;
    display: block;
    width: calc(100% - 20px);
}

.nav-link:hover {
    background-color: rgba(253, 203, 5, 0.15);
    color: ;
}

.nav-link.active {
    background-color: var(--teal-glacier);
    color: var(--white-bg);
    font-weight: 500;
}

.nav-link.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 70%;
    background-color: var(--yellow-canaan);
    border-radius: 0 4px 4px 0;
}

.nav-link.text-danger {
    color: var(--pink-swoosh) !important;
}

.nav-link.text-danger:hover {
    background-color: rgba(233, 30, 99, 0.15);
    color: var(--pink-swoosh) !important;
}

/* Ajustement pour le contenu principal */
.content {
    margin-left: 250px;
    width: calc(100% - 250px);
}
</style>